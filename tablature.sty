\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{tablature}[Create guitar tablatures]

% custom clef
\newcommand\TAB[1]{%
  \setclefsymbol{#1}{\,\rotatebox{90}{TAB}}%
  \setclef{#1}9}

% internal string choosing command
%  #1: string (a number from 1--6)
%  #2: finger
\makeatletter
\newcommand\@str[2]{%
  \ifcase#1\relax\@strerror
  \or\def\@strnr{-1}%
  \or\def\@strnr{1}%
  \or\def\@strnr{3}%
  \or\def\@strnr{5}%
  \or\def\@strnr{7}%
  \or\def\@strnr{9}%
  \else\@strerror
  \fi
  \zchar\@strnr{\footnotesize#2}}
% \@strerror could be defined to issue some warning/error

% User level commands
\newcommand\STr[2]{\@str{#1}{#2}\sk}  % with a full note skip
\newcommand\Str[2]{\@str{#1}{#2}\hsk} % with a half note skip
\newcommand\str[2]{\@str{#1}{#2}}     % with no skip
\newcommand\chord[1]{\zchar{13}{\printchord{#1}}}
\makeatother

\setlength\parindent{0pt}
\smallmusicsize

\newenvironment{tablature}{
    \begin{music}
    \instrumentnumber{1}
    \nobarnumbers
    \TAB1
    \generalmeter{\meterfrac{4}4}
    \setlines1{6}
    \startpiece
} {
    \endpiece
    \end{music}
}

\endinput
